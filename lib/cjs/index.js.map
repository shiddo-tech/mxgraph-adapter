{"version":3,"file":"index.js","sources":["../../node_modules/style-inject/dist/style-inject.es.js","../../src/mxgraph/mxgraph.enums.js","../../src/utils/adapter.utils.js","../../src/utils/file.utils.js","../../src/mxgraph/mxgraph.mapper.js","../../src/mxgraph/mxgraph.import.js","../../src/mxgraph/mxgraph.export.js","../../src/mxgraph.toolbar.js"],"sourcesContent":["function styleInject(css, ref) {\n  if ( ref === void 0 ) ref = {};\n  var insertAt = ref.insertAt;\n\n  if (!css || typeof document === 'undefined') { return; }\n\n  var head = document.head || document.getElementsByTagName('head')[0];\n  var style = document.createElement('style');\n  style.type = 'text/css';\n\n  if (insertAt === 'top') {\n    if (head.firstChild) {\n      head.insertBefore(style, head.firstChild);\n    } else {\n      head.appendChild(style);\n    }\n  } else {\n    head.appendChild(style);\n  }\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nexport default styleInject;\n","export const Application = {\n  GOVERNANCE: 'GOVERNANCE',\n  STUDIO: 'STUDIO',\n};\n\nexport const DiagramType = {\n  bpmn: 'bpmn',\n  process: 'process',\n};\n\nexport const FileExtension = {\n  MODELER: 'mdr',\n};\n\nexport const FileError = {\n  EMPTY_FILE: 'EMPTY_FILE',\n  INVALID_FILE: 'INVALID_FILE',\n  INVALID_DATA: 'INVALID_DATA',\n  CONTAIN_NO_CELLS: 'CONTAIN_NO_CELLS'\n};\n","import { xml2json, json2xml } from 'xml-js';\n\nfunction sanitizeValue(value) {\n  const breakLine = '&#xA;';\n\n  return value.replaceAll('\\n', breakLine);\n}\n\nexport function convertXmlToJson(xml, options = { compact: true, spaces: 4 }) {\n  if (!xml) {\n    return;\n  }\n\n  return JSON.parse(\n    xml2json(xml, { ...options, attributeValueFn: sanitizeValue })\n  );\n}\n\nexport function convertJsonToXml(json, options = { compact: true, spaces: 4 }) {\n  if (!json) {\n    return;\n  }\n\n  return json2xml(json, options);\n}\n\nexport function downloadFile({\n  filename,\n  content,\n  extension = 'xml',\n  type = 'application/xml',\n}) {\n  const blob = new Blob([content], { type });\n  const url = window.URL.createObjectURL(blob);\n\n  const linkElement = document.createElement('a');\n  linkElement.href = url;\n  linkElement.download = `${filename}.${extension}`;\n  linkElement.click();\n}\n\nexport function getXmlGraph(graph) {\n  const codec = new window.mxCodec();\n  const xmlModel = codec.encode(graph.getModel());\n  const rootElement = xmlModel.getElementsByTagName('root')[0];\n\n  rootElement.setAttribute('version', '1.1');\n\n  return xmlModel;\n}\n\nexport function getXmlTextGraph(graph) {\n  const xmlGrapah = getXmlGraph(graph);\n  return mxUtils.getXml(xmlGrapah);\n}\n","import { FileExtension } from '../mxgraph/mxgraph.enums';\n\nfunction removeElement(element) {\n  return element.parentElement.removeChild(element);\n}\n\nfunction readFile(event) {\n  return new Promise((resolve) => {\n    const fileInput = event.target;\n    const file = event.target.files[0];\n\n    const reader = new FileReader();\n    reader.onload = (e) => {\n      removeElement(fileInput);\n      resolve(e.target.result);\n    };\n    reader.readAsText(file);\n  });\n}\n\nexport function openFile() {\n  return new Promise((resolve) => {\n    const fileInput = document.createElement('input');\n    fileInput.type = 'file';\n    fileInput.style.display = 'none';\n    fileInput.accept = `.${FileExtension.MODELER}`;\n\n    fileInput.onchange = async (event) => {\n      const fileContent = await readFile(event);\n      resolve(fileContent);\n    };\n\n    document.body.appendChild(fileInput);\n    fileInput.click();\n  });\n}\n","import { Application } from './mxgraph.enums';\n\nconst { GOVERNANCE, STUDIO } = Application;\n\nexport function mapCells({ mxCells, metadata, consumer }) {\n  // TODO Tratar metadata\n  const { app, diagramType, version } = metadata;\n\n  const sourceApp = app._text;\n  const targetApp = consumer;\n\n  if (sourceApp === GOVERNANCE && targetApp === STUDIO) {\n    const markersNotSupported = [\n      'markerPoint',\n      'marker-loop',\n      'marker-ad-hoc',\n      'marker-compensation',\n      'marker-sequential-mi',\n      'marker-parallel-mi',\n    ];\n\n    return mxCells\n      .filter((cell) => !markersNotSupported.includes(cell._attributes?.style))\n      .map((cell) => {\n        let { type, subType, style, value } = cell?._attributes || {};\n\n        const breakLine = '&#xA;';\n        const normalizeValue = value ? `${value}${breakLine}` : '';\n\n        if (type === 'TASK' && subType !== 'none') {\n          cell._attributes.style = 'task';\n          cell._attributes.subType = 'none';\n        }\n\n        if (\n          type === 'GATEWAY' &&\n          ['none', 'inclusive', 'event-based'].includes(subType)\n        ) {\n          cell._attributes.style = 'gateway-exclusive';\n          cell._attributes.subType = 'exclusive';\n        }\n\n        if (type === 'START_EVENT') {\n          if (!['none'].includes(subType)) {\n            cell._attributes.style = 'start-event';\n            cell._attributes.subType = 'none';\n          }\n\n          cell.mxGeometry._attributes.width = 32;\n          cell.mxGeometry._attributes.height = 32;\n        }\n\n        if (type === 'END_EVENT') {\n          cell._attributes.style = 'end-event-terminate';\n          cell._attributes.subType = 'none';\n          cell.mxGeometry._attributes.width = 32;\n          cell.mxGeometry._attributes.height = 32;\n        }\n\n        // Elementos não suportados\n        if (type === 'INTERMEDIATE_EVENT') {\n          cell._attributes.value = `${normalizeValue}${style}${breakLine}não suportado`;\n          cell._attributes.subType = 'none';\n          cell._attributes.style = 'task';\n          cell.mxGeometry._attributes.width = 230;\n          cell.mxGeometry._attributes.height = 82;\n        }\n\n        if (['DATA_STORE', 'WORKFLOW_INTERFACE'].includes(type)) {\n          cell._attributes.value = `${normalizeValue}${style}${breakLine}não suportado`;\n          cell._attributes.subType = 'none';\n          cell._attributes.style = 'task';\n          cell.mxGeometry._attributes.width = 230;\n          cell.mxGeometry._attributes.height = 82;\n        }\n\n        return cell;\n      });\n  }\n\n  return mxCells;\n}\n","// Enums\nimport { FileError } from './mxgraph.enums';\n\n// Utils\nimport { convertXmlToJson, convertJsonToXml } from '../utils/adapter.utils';\nimport * as FileUtils from '../utils/file.utils';\n\n// Mappers\nimport { mapCells } from './mxgraph.mapper';\n\nexport async function importMxGraphFile({ consumer }) {\n  const modelerContent = await FileUtils.openFile();\n  const jsonContent = convertXmlToJson(modelerContent);\n\n  if (!jsonContent) {\n    throw new Error(FileError.EMPTY_FILE);\n  }\n\n  const { metadata, mxGraphModel } = jsonContent.modeler || {};\n\n  const validMetadata =\n    metadata?.app && metadata?.diagramType && metadata?.version;\n\n  const validMxGraphModel = mxGraphModel?.root;\n\n  if (!validMetadata || !validMxGraphModel) {\n    throw new Error(FileError.INVALID_FILE);\n  }\n\n  const containCells = Object.keys(mxGraphModel.root.mxCell || {}).length;\n\n  if (!containCells) {\n    throw new Error(FileError.CONTAIN_NO_CELLS);\n  }\n\n  mxGraphModel.root.mxCell = mapCells({\n    mxCells: mxGraphModel.root.mxCell,\n    metadata,\n    consumer,\n  });\n\n  return convertJsonToXml({ mxGraphModel });\n}\n","// Enums\nimport { FileExtension, FileError } from './mxgraph.enums';\n\n// Utils\nimport {\n  convertXmlToJson,\n  convertJsonToXml,\n  downloadFile,\n} from '../utils/adapter.utils';\n\nexport function exportMxGraphFile({ xml = '', metadata }) {\n  let jsonContent = convertXmlToJson(xml);\n\n  if (!jsonContent) {\n    throw new Errorr(FileError.EMPTY_FILE);\n  }\n\n  const modelerContent = {\n    modeler: Object.assign({ metadata }, jsonContent),\n  };\n\n  const xmlContent = convertJsonToXml(modelerContent);\n\n  downloadFile({\n    filename: 'workflow',\n    content: xmlContent,\n    extension: FileExtension.MODELER,\n  });\n}\n","import { Application, DiagramType, FileError } from './mxgraph/mxgraph.enums';\nimport { getXmlTextGraph } from './utils/adapter.utils';\nimport { importMxGraphFile, exportMxGraphFile } from './mxgraph';\n\nconst { GOVERNANCE, STUDIO } = Application;\nconst { bpmn } = DiagramType;\n\nclass MxGraphToolbar {\n  app = null;\n  version = null;\n  diagramType = null;\n  graph = null;\n  renderGraph = null;\n  toolbar = null;\n  importButton = null;\n  exportButton = null;\n  notification = null;\n  messages = {\n    exportTitle: 'Exportar diagrama da plataforma Governance',\n    importTitle: 'Importar diagrama da plataforma Governance',\n    importTitleDisabled:\n      'Não é possível importar o diagrama da plataforma Governance, pois o diagrama já foi iniciado',\n    emptyFile: 'Arquivo em branco',\n    invalidFile: 'Arquivo inválido',\n    containNoCells: 'Não foram encontradas células para serem importadas',\n    errorImportingFile: 'Erro ao importar arquivo',\n    errorExportingFile: 'Erro ao exportar arquivo',\n  };\n\n  init({\n    app,\n    version,\n    diagramType,\n    graph,\n    renderGraph,\n    notification,\n    customClass = '',\n    messages = {},\n  }) {\n    // com app é possível identificar se é STUDIO ou GOVERNANCE\n    this.app = app;\n    this.version = version;\n    this.diagramType = diagramType;\n    this.graph = graph;\n    this.notification = notification;\n    this.renderGraph = renderGraph;\n    this.initialCellsNumber = Object.keys(this.graph.model.cells).length;\n\n    this.messages = {\n      ...this.messages,\n      ...messages,\n    };\n\n    if (!this.graph) {\n      throw new Error('Graph not found');\n    }\n\n    if (!this.app) {\n      throw new Error('App not found');\n    }\n\n    if (!this.renderGraph) {\n      throw new Error('Render graph not found');\n    }\n\n    if (!this.notification) {\n      throw new Error('Notification system not found');\n    }\n\n    if (this.diagramType !== bpmn) {\n      console.warn(`Unsupported ${this.diagramType}`);\n      return;\n    }\n\n    this.createToolbar({\n      customClass,\n    });\n  }\n\n  canImportFile() {\n    const currentCellsNumber = Object.keys(this.graph.model.cells).length;\n\n    // A estrutura do studio inicia com 2 células\n    if (this.app === STUDIO) {\n      return this.initialCellsNumber === 2 && currentCellsNumber === 2;\n    }\n\n    // A estrutura do Governance inicia com 5 células\n    return this.initialCellsNumber <= 5 && currentCellsNumber <= 5;\n  }\n\n  createToolbar({ customClass }) {\n    this.toolbar = document.createElement('div');\n    this.toolbar.classList.add('mxgraph-import-export-toolbar');\n\n    if (customClass) {\n      this.toolbar.classList.add(customClass);\n    }\n\n    const shouldImportFile = this.canImportFile();\n\n    if (this.app === STUDIO) {\n      this.importButton = document.createElement('button');\n      this.importButton.classList.add('import-button', 'btn');\n      // this.importButton.disabled = !shouldImportFile;\n      this.importButton.title = shouldImportFile\n        ? this.messages.importTitle\n        : this.messages.importTitleDisabled;\n\n      this.importButton.innerHTML = `\n        <svg width=\"40\" height=\"40\" viewBox=\"0 0 40 40\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n          <path d=\"M29.06 14.3607L31.56 12M31.56 12L34.06 14.3607M31.56 12L31.56 21\" stroke=\"black\" stroke-width=\"1.5\"/>\n          <path d=\"M11.86 19.14H10.04V17.48C10.04 17.24 10 17.0867 9.92 17.02C9.84 16.94 9.68 16.9 9.44 16.9H8.42C8.18 16.9 8.02 16.94 7.94 17.02C7.86 17.0867 7.82 17.24 7.82 17.48V26.02C7.82 26.26 7.86 26.42 7.94 26.5C8.02 26.5667 8.18 26.6 8.42 26.6H9.44C9.68 26.6 9.84 26.5667 9.92 26.5C10 26.42 10.04 26.26 10.04 26.02V22.96H9.04V21.56H11.86V26.24C11.86 27.4267 11.24 28.02 10 28.02H7.86C6.62 28.02 6 27.4267 6 26.24V17.24C6 16.0667 6.62 15.48 7.86 15.48H10C11.24 15.48 11.86 16.0667 11.86 17.24V19.14Z\" fill=\"black\"/>\n          <path d=\"M15.5167 15.48H17.7367C18.9767 15.48 19.5967 16.0667 19.5967 17.24V26.24C19.5967 27.4133 18.9767 28 17.7367 28H15.5167C14.2634 28 13.6367 27.4133 13.6367 26.24V17.24C13.6367 16.0667 14.2634 15.48 15.5167 15.48ZM17.7967 25.96V17.52C17.7967 17.28 17.7567 17.1267 17.6767 17.06C17.5967 16.98 17.4367 16.94 17.1967 16.94H16.0367C15.7967 16.94 15.6367 16.98 15.5567 17.06C15.4901 17.1267 15.4567 17.28 15.4567 17.52V25.96C15.4567 26.2 15.4901 26.36 15.5567 26.44C15.6367 26.5067 15.7967 26.54 16.0367 26.54H17.1967C17.4367 26.54 17.5967 26.5067 17.6767 26.44C17.7567 26.36 17.7967 26.2 17.7967 25.96Z\" fill=\"black\"/>\n          <path d=\"M25.8683 15.48H27.7283L25.4683 28H22.9083L20.6483 15.48H22.5083L24.1683 26.34L25.8683 15.48Z\" fill=\"black\"/>\n        </svg>      \n      `;\n\n      this.toolbar.appendChild(this.importButton);\n\n      this.importButton.addEventListener(\n        'click',\n        this.onClickImportButton.bind(this)\n      );\n    }\n\n    if (this.app === GOVERNANCE) {\n      this.exportButton = document.createElement('button');\n      this.exportButton.classList.add('export-button', 'btn');\n      this.exportButton.title = this.messages.exportTitle;\n\n      this.exportButton.innerHTML = `\n        <svg width=\"40\" height=\"40\" viewBox=\"0 0 40 40\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n          <path d=\"M34.06 18.6393L31.56 21M31.56 21L29.06 18.6393M31.56 21L31.56 12\" stroke=\"black\" stroke-width=\"1.5\"/>\n          <path d=\"M11.86 19.14H10.04V17.48C10.04 17.24 10 17.0867 9.92 17.02C9.84 16.94 9.68 16.9 9.44 16.9H8.42C8.18 16.9 8.02 16.94 7.94 17.02C7.86 17.0867 7.82 17.24 7.82 17.48V26.02C7.82 26.26 7.86 26.42 7.94 26.5C8.02 26.5667 8.18 26.6 8.42 26.6H9.44C9.68 26.6 9.84 26.5667 9.92 26.5C10 26.42 10.04 26.26 10.04 26.02V22.96H9.04V21.56H11.86V26.24C11.86 27.4267 11.24 28.02 10 28.02H7.86C6.62 28.02 6 27.4267 6 26.24V17.24C6 16.0667 6.62 15.48 7.86 15.48H10C11.24 15.48 11.86 16.0667 11.86 17.24V19.14Z\" fill=\"black\"/>\n          <path d=\"M15.5167 15.48H17.7367C18.9767 15.48 19.5967 16.0667 19.5967 17.24V26.24C19.5967 27.4133 18.9767 28 17.7367 28H15.5167C14.2634 28 13.6367 27.4133 13.6367 26.24V17.24C13.6367 16.0667 14.2634 15.48 15.5167 15.48ZM17.7967 25.96V17.52C17.7967 17.28 17.7567 17.1267 17.6767 17.06C17.5967 16.98 17.4367 16.94 17.1967 16.94H16.0367C15.7967 16.94 15.6367 16.98 15.5567 17.06C15.4901 17.1267 15.4567 17.28 15.4567 17.52V25.96C15.4567 26.2 15.4901 26.36 15.5567 26.44C15.6367 26.5067 15.7967 26.54 16.0367 26.54H17.1967C17.4367 26.54 17.5967 26.5067 17.6767 26.44C17.7567 26.36 17.7967 26.2 17.7967 25.96Z\" fill=\"black\"/>\n          <path d=\"M25.8683 15.48H27.7283L25.4683 28H22.9083L20.6483 15.48H22.5083L24.1683 26.34L25.8683 15.48Z\" fill=\"black\"/>\n        </svg>\n      `;\n\n      this.toolbar.appendChild(this.exportButton);\n\n      this.exportButton.addEventListener(\n        'click',\n        this.onClickExportButton.bind(this)\n      );\n    }\n\n    document.body.appendChild(this.toolbar);\n  }\n\n  async onClickImportButton() {\n    try {\n      if (!this.canImportFile()) {\n        this.showError(this.messages.importTitleDisabled);\n        return;\n      }\n\n      const modelerXml = await importMxGraphFile({\n        consumer: this.app,\n      });\n\n      this.renderGraph(modelerXml);\n    } catch (error) {\n      let message = this.messages.errorImportingFile;\n\n      if (error.message === FileError.EMPTY_FILE) {\n        message = this.messages.emptyFile || message;\n      }\n\n      if (error.message === FileError.INVALID_FILE) {\n        message = this.messages.invalidFile || message;\n      }\n\n      if (error.message === FileError.CONTAIN_NO_CELLS) {\n        message = this.messages.containNoCells || message;\n      }\n\n      this.showError(message);\n    }\n  }\n\n  showError(message) {\n    this.notification.error({\n      position: 'topRight',\n      timeout: 1000 * 4,\n      progressBar: true,\n      message,\n    });\n  }\n\n  onClickExportButton() {\n    try {\n      const xml = getXmlTextGraph(this.graph);\n      const metadata = {\n        app: this.app,\n        version: this.version,\n        diagramType: this.diagramType,\n      };\n\n      exportMxGraphFile({ xml, metadata });\n    } catch (error) {\n      this.notification.error({\n        position: 'topRight',\n        timeout: 1000 * 4,\n        progressBar: true,\n        message: this.messages.errorExportingFile,\n      });\n    }\n  }\n}\n\nexport default new MxGraphToolbar();\n"],"names":["css","ref","insertAt","document","head","getElementsByTagName","style","createElement","type","firstChild","insertBefore","appendChild","styleSheet","cssText","createTextNode","Application","FileExtension","FileError","sanitizeValue","value","replaceAll","convertXmlToJson","xml","options","arguments","length","undefined","compact","spaces","JSON","parse","xml2json","attributeValueFn","convertJsonToXml","json","json2xml","getXmlTextGraph","graph","xmlGrapah","xmlModel","window","mxCodec","encode","getModel","setAttribute","getXmlGraph","mxUtils","getXml","readFile","event","Promise","resolve","fileInput","target","file","files","reader","FileReader","onload","e","element","parentElement","removeChild","result","readAsText","openFile","display","accept","concat","onchange","_ref","_asyncToGenerator","_regeneratorRuntime","mark","fileContent","wrap","_context","prev","next","sent","stop","_callee","_x","apply","this","body","click","GOVERNANCE","STUDIO","mapCells","mxCells","metadata","consumer","app","diagramType","version","_text","markersNotSupported","filter","cell","_cell$_attributes","includes","_attributes","map","_ref2","subType","breakLine","normalizeValue","mxGeometry","width","height","importMxGraphFile","_importMxGraphFile","modelerContent","jsonContent","mxGraphModel","validMetadata","validMxGraphModel","FileUtils","Error","modeler","root","Object","keys","mxCell","abrupt","exportMxGraphFile","_ref$xml","Errorr","filename","content","_ref$extension","extension","_ref$type","blob","Blob","url","URL","createObjectURL","linkElement","href","download","downloadFile","assign","mxgraph_toolbar","MxGraphToolbar","_classCallCheck","_defineProperty","exportTitle","importTitle","importTitleDisabled","emptyFile","invalidFile","containNoCells","errorImportingFile","errorExportingFile","_onClickImportButton","key","renderGraph","notification","_ref$customClass","customClass","_ref$messages","messages","initialCellsNumber","model","cells","_objectSpread","createToolbar","console","warn","currentCellsNumber","toolbar","classList","add","shouldImportFile","canImportFile","importButton","title","innerHTML","addEventListener","onClickImportButton","bind","exportButton","onClickExportButton","modelerXml","message","showError","t0","error","position","timeout","progressBar"],"mappings":"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"}